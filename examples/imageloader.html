<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Image Loader</title>
    </head>
    <body>
        <div id="images"></div>

        <script src="/underarm.js"></script>
        <!--<script src="/build/underarm-0.0.1.js"></script>-->
        <!--<script src="/build/underarm-0.0.1.min.js"></script>-->
        <script>
        ;(function(){
            var characters = [
                  'jellyfish'
                , 'shark'
                , 'lizard'
                , 'pufferfish'
                , 'leopard'
                , 'shrimp']

              , loadImages = _r(characters)
                  .map(function(character){
                    return {
                        name: character
                      , src: "http://simplectic.com/img/storyturtle/"+character+".png"
                      , loadImage: function(){
                          var self = this
                            , promise = _r.promise()
                          self.image = document.createElement('img')
                          self.image.onload = function(){
                            promise.resolve(self)
                          }
                          self.image.src = self.src
                          return promise
                        }
                    }})
                  .call('loadImage')
                  .sortBy('name')
                  .pluck('image')

                var el = document.getElementById('images')
                loadImages.subscribe(function(image){el.appendChild(image)})
        })()
        </script>
    </body>
</html>
