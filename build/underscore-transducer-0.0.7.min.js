!function(){function n(n){this.value=n}var e,t=this,u=t._r,i=Array.prototype.slice,o=function(n,r){if(n instanceof o){if(r===e)return n;var t=a.clone(n._wrappedFns);t.push(r);var u=new o(n._wrapped,t);return u._resolveSingleValue=n._resolveSingleValue,u}return this instanceof o?(this._wrapped=o.wrap(n),r instanceof o&&(r=r._wrappedFns,this._resolveSingleValue=r._resolveSingleValue),this._wrappedFns=a.isFunction(r)?[r]:a.isArray(r)?a.filter(r,a.isFunction):[],void 0):new o(n,r)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports._r=o):t._r=o,o.VERSION="0.0.7";var a=t._;"undefined"==typeof a&&"undefined"!=typeof require&&(a=require("underscore")._),o.each=o.forEach=function(n){return function(r){return function(t,u,i){return t===e?r():u===e?r(t):(n(u,i),r(t,u,i))}}},o.map=o.collect=function(n){return n=a.iteratee(n),function(r){return function(t,u,i){return t===e?r():u===e?r(t):r(t,n(u,i),i)}}},o.find=o.detect=function(n){return n=a.iteratee(n),o.resolveSingleValue(this),function(r){return function(t,u,i){return t===e?r():u===e?r(t):n(u,i)?o.reduced(r(t,u,i)):t}}},o.filter=o.select=function(n){return n=a.iteratee(n),function(r){return function(t,u,i){return t===e?r():u===e?r(t):n(u,i)?r(t,u,i):t}}},o.reject=function(n){return o.filter(a.negate(a.iteratee(n)))},o.every=o.all=function(n){return n=a.iteratee(n),o.resolveSingleValue(this),function(r){var t=!1;return function(u,i,a){return u===e?r():i===e?(t||(u=r(u,!0)),r(u)):n(i,a)?u:(t=!0,o.reduced(r(u,!1)))}}},o.some=o.any=function(n){return n=a.iteratee(n),o.resolveSingleValue(this),function(r){var t=!1;return function(u,i,a){return u===e?r():i===e?(t||(u=r(u,t)),r(u)):n(i,a)?(t=!0,o.reduced(r(u,t,a))):u}}},o.contains=o.include=function(n){return o.some.call(this,function(r){return r===n})},o.invoke=function(n){var r=i.call(arguments,2),e=a.isFunction(n);return o.map(function(t){return(e?n:t[n]).apply(t,r)})},o.pluck=function(n){return o.map(a.property(n))},o.where=function(n){return o.filter(a.matches(n))},o.findWhere=function(n){return o.find.call(this,a.matches(n))},o.max=function(n){return n=a.iteratee(n),o.resolveSingleValue(this),function(r){var t,u=-1/0,i=-1/0;return function(o,a,c){return o===e?r():a===e?(o=r(o,u),r(o)):(t=n(a,c),(t>i||t===-1/0&&u===-1/0)&&(u=a,i=t),o)}}},o.min=function(n){return n=a.iteratee(n),o.resolveSingleValue(this),function(r){var t,u=1/0,i=1/0;return function(o,a,c){return o===e?r():a===e?(o=r(o,u),r(o)):(t=n(a,c),(i>t||1/0===t&&1/0===u)&&(u=a,i=t),o)}}},o.push=function(){var n=a.toArray(arguments);return function(r){return function(t,u,i){if(t===e)return r();if(u===e){var o,a=n.length;for(o=0;a>o;o++)t=r(t,n[o]);return r(t)}return r(t,u,i)}}},o.unshift=function(){var n=a.toArray(arguments);return function(r){return function(t,u,i){if(t===e)return r();if(u===e)return r(t);if(n){var o,a=n.length;for(o=0;a>o;o++)t=r(t,n[o]);n=null}return r(t,u,i)}}},o.first=o.head=o.take=function(n){return n===e?(o.resolveSingleValue(this),n=1):n=n>0?n:0,function(r){var t=n;return function(n,u,i){return n===e?r():u===e?r(n):(t>0&&(n=r(n,u,i)),--t?n:o.reduced(n))}}},o.initial=function(n){return n=n===e?1:n>0?n:0,function(r){var t=0,u=[],i=0;return function(o,a){if(o===e)return r();if(a===e){for(t=i-n,i=0;t>i;i++)o=r(o,u[i]);return r(o)}return u[i++]=a,o}}},o.last=function(n){return n===e?(o.resolveSingleValue(this),n=1):n=n>0?n:0,function(r){var t=n,u=[],i=0;return function(o,a){if(o===e)return r();if(a===e){for(;t--;)o=r(o,u[i++%n]);return r(o)}return u[i++%n]=a,o}}},o.rest=o.tail=o.drop=function(n){return n=n===e?1:n>0?n:0,function(r){var t=n;return function(n,u,i){return n===e?r():u===e?r(n):t>0?(t--,n):r(n,u,i)}}},o.compact=function(){return o.filter(a.identity)},o.uniq=o.unique=function(n,r){return a.isBoolean(n)||(r=n,n=!1),null!=r&&(r=a.iteratee(r)),function(t){var u=[],i=0;return function(o,c,f){if(o===e)return t();if(c===e)return t(o);if(n)i&&u===c||(o=t(o,c,f)),u=c;else if(r){var s=r(c,i,o);a.indexOf(u,s)<0&&(u.push(s),o=t(o,c,f))}else a.indexOf(u,c)<0&&(u.push(c),o=t(o,c,f));return++i,o}}},o.tap=function(n){return function(r){return function(t,u,i){return t===e?r():u===e?r(t):(n(t,u,i),r(t,u,i))}}},o.mixin=function(n){a.each(a.functions(n),function(r){var e=o[r]=n[r];o.prototype[r]=function(){var n=e.apply(this,arguments);return o(this,n)}})},o.mixin(o),o.noConflict=function(){return t._r=u,this},o.prototype.withSource=function(n){return o(n,this)},o.prototype.transducer=o.prototype.compose=function(){var n=this._wrappedFns;return n.length?a.compose.apply(null,n):e},o.resolveSingleValue=function(n){n instanceof o&&(n._resolveSingleValue=!0)};var c={};o.prototype.value=function(){if(!this._resolveSingleValue)return this.into();var n=this.into(c);return n===c?e:n};var f=a.reduce(["iterator","empty","append","wrap","unwrap"],function(n,r){var t=function(){for(var n,u=arguments,i=t._fns,o=i.length;o--;)if(n=i[o].apply(null,u),n!==e)return n;throw new TypeError("cannot find match for "+r+" "+a.toArray(u))};return t._fns=[],t.register=function(n){t._fns.push(n)},n[r]=t,n},{});o.wrap=function(n){return f.wrap(n)},o.wrap.register=function(n){return f.wrap.register(n)},o.wrap.register(function(n){return n===e&&(n=o.empty()),n}),o.unwrap=o.deref=function(n){return f.unwrap(n)},o.unwrap.register=function(n){return f.unwrap.register(n)},o.unwrap.register(function(n){return o.isReduced(n)?n.value:n instanceof o?r.value():n}),o.iterator=function(n){return f.iterator(n)},o.iterator.register=function(n){return f.iterator.register(n)};var s="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator";o.iterator.Symbol=s,o.iterator.register(function(n){if(a.isObject(n)){var r=n[s]&&n[s]()||n;if(a.isFunction(r.next))return r}return null}),o.empty=function(n){return n===c?c:f.empty(n)},o.empty.register=function(n){return f.empty.register(n)},o.empty.register(function(n){return n===e||a.isArray(n)?[]:a.isObject(n)?{}:c}),o.append=o.conj=o.conjoin=function(n,r,t){return n===e?[]:r===e?o.unwrap(n):r===c?n:n===c?r:f.append(n,r,t)},o.append.register=function(n){return f.append.register(n)},o.append.register(function(n,r,t){return a.isArray(n)?(n.push(r),n):t!==e&&a.isObject(n)?(n[t]=r,n):r}),o.reduced=function(r){return new n(r)},o.isReduced=function(r){return r instanceof n};var l="Reduce of empty array with no initial value";o.reduce=o.foldl=o.inject=function(n,r,e){null==n&&(n=o.empty());var t,u=n.length!==+n.length&&a.keys(n),i=(u||n).length,c=0,f=o.iterator(n);if(f&&a.isFunction(f.next))for(;;){if(t=f.next(),t.done)return e;if(e=r(e,t.value,c++,n),o.isReduced(e))return o.unwrap(e)}else{if(arguments.length<3){if(!i)throw new TypeError(l);e=n[u?u[c++]:c++]}for(;i>c;c++)if(t=u?u[c]:c,e=r(e,n[t],t,n),o.isReduced(e))return o.unwrap(e)}return e},o.transduce=function(n,r,t,u){return r===e&&(r=o.empty()),t===e&&(t=o.append),u===e&&(u=t()),n instanceof o&&(n=n.transducer()),n!==e&&(t=n(t)),t(o.reduce(r,t,u))},o.prototype.transduce=function(n,r,t){return n===e?o.transduce(this.transducer(),this._wrapped,n,r):o.transduce(this.transducer(),n,r,t)},o.asCallback=function(n,r){var t=!1,u=o.append;return r===e&&(r=null),u=n(u),function(n){t||(n===e?(r=u(r),t=!0):(r=u(r,n),o.isReduced(r)&&(r=u(o.unwrap(r)),t=!0)))}},o.prototype.asCallback=function(n){return o.asCallback(this.transducer(),n)},o.asyncCallback=function(n,r,t){function u(n,u){if(i)return!0;if(n=n||null,o.isReduced(t)&&(t=o.unwrap(t),i=!0),(n||i||u===e)&&(t=a(t),i=!0),i){if(r)r(n,t),r=null;else if(n)throw n;t=null}return i}var i=!1,a=o.append;return t===e&&(t=null),a=n(a),function(n,r){if(!u(n,r))try{t=a(t,r),u(n,r)}catch(e){u(e,r)}}},o.prototype.asyncCallback=function(n,r){return o.asyncCallback(this.transducer(),n,r)},o.into=function(n,r,t){var u=o.append;return t===e&&(t=r,r=e),t===e&&(t=o.empty()),r===e?o.reduce(t,u,n):o.transduce(r,t,u,n)},o.prototype.into=function(n,r){return r===e&&(r=this._wrapped),r===e&&(r=o.empty()),n===e&&(n=o.empty(r)),o.into(n,this.transducer(),r)},o.sequence=function(n,r){return r==e?(r=n,o.into(o.empty(r),r)):o.into(o.empty(r),n,r)},o.prototype.sequence=function(n){return n==e&&(n=this._wrapped),this.into(o.empty(n),n)},o.generate=function(n,r){var t={};return t[s]=function(){var t=r?n():n;return{next:function(){var n=t();return n===e?{done:!0}:{done:!1,value:n}}}},t},o.prototype.generate=function(n,r){return this.withSource(o.generate(n,r))},"function"==typeof define&&define.amd&&define("underscore.transducer",[],function(){return o})}.call(this);