!function(){function t(){return this.xf.init()}function e(t,e){return this.xf.step(t,e)}function n(t){return this.xf.result(t)}function i(t,e){this.xf=e,this.f=t,this.i=0}function u(t,e){this.xf=e,this.f=t}function o(t,e){this.xf=e,this.f=t,this.found=!1}function s(t,e){this.xf=e,this.f=t,this.found=!1}function p(t,e){this.xf=e,this.f=t,this.computedResult=-1/0,this.lastComputed=-1/0}function f(t,e){this.xf=e,this.f=t,this.computedResult=1/0,this.lastComputed=1/0}function c(t,e){this.xf=e,this.toPush=t}function a(t,e){this.xf=e,this.toUnshift=t}function h(t,e){this.xf=e,this.n=t,this.idx=0,this.buffer=[]}function l(t,e){this.xf=e,this.n=t,this.idx=0,this.buffer=[]}function d(t,e,n){this.xf=n,this.f=t,this.isSorted=e,this.seen=[],this.i=0}function y(t,e){this.xf=e,this.f=t,this.i=0}function m(t,e){V.as(t)&&(t._resolveSingleValue=e)}function v(t){return function(e){return t.withSource(e).value()}}function x(){}function w(){}var g,S=this,_=S._r,b=Array.prototype.slice,V=function(t,e){if(V.as(t)){if(e===g)return t;var n=R.clone(t._wrappedFns);n.push(e);var r=new V(t._wrapped,n);return r._resolveSingleValue=t._resolveSingleValue,r}return V.as(this)?(V.as(e)&&(this._resolveSingleValue=e._resolveSingleValue,e=e._wrappedFns),this._wrappedFns=R.isFunction(e)?[e]:R.isArray(e)?R.filter(e,R.isFunction):[],this._wrapped=V.wrap.call(this,t),void 0):new V(t,e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=V),exports._r=V):S._r=V,V.VERSION="0.0.9";var R=S._,C=S.transducers;"undefined"==typeof R&&"undefined"!=typeof require&&(R=require("underscore"),C=require("transducers-js")),V.each=V.forEach=function(t){return function(e){return new i(t,e)}},i.prototype.init=t,i.prototype.result=n,i.prototype.step=function(t,e){return this.f(e,this.i++),this.xf.step(t,e)},V.map=V.collect=function(t){return C.map(V.iteratee(t))},V.find=V.detect=function(t){return t=V.iteratee(t),V.resolveSingleValue(this),function(e){return new u(t,e)}},u.prototype.init=t,u.prototype.result=n,u.prototype.step=function(t,e){return this.f(e)?V.reduced(this.xf.step(t,e)):t},V.filter=V.select=function(t){return t=V.iteratee(t),C.filter(t)},V.reject=V.remove=function(t){return C.remove(V.iteratee(t))},V.every=V.all=function(t){return t=V.iteratee(t),V.resolveSingleValue(this),function(e){return new o(t,e)}},o.prototype.init=t,o.prototype.result=function(t){return this.found||(t=this.xf.step(t,!0)),this.xf.result(t)},o.prototype.step=function(t,e){return this.f(e)?t:(this.found=!0,V.reduced(this.xf.step(t,!1)))},V.some=V.any=function(t){return t=V.iteratee(t),V.resolveSingleValue(this),function(e){return new s(t,e)}},s.prototype.init=t,s.prototype.result=function(t){return this.found||(t=this.xf.step(t,!1)),this.xf.result(t)},s.prototype.step=function(t,e){return this.f(e)?(this.found=!0,V.reduced(this.xf.step(t,!0))):t},V.contains=V.include=function(t){return V.some.call(this,function(e){return e===t})},V.invoke=function(t){var e=b.call(arguments,2),n=R.isFunction(t);return V.map(function(r){return(n?t:r[t]).apply(r,e)})},V.pluck=function(t){return V.map(R.property(t))},V.where=function(t){return V.filter(R.matches(t))},V.findWhere=function(t){return V.find.call(this,R.matches(t))},V.max=function(t){return t=V.iteratee(t),V.resolveSingleValue(this),function(e){return new p(t,e)}},p.prototype.init=t,p.prototype.result=function(t){return t=this.xf.step(t,this.computedResult),this.xf.result(t)},p.prototype.step=function(t,e){var n=this.f(e);return(n>this.lastComputed||n===-1/0&&this.computedResult===-1/0)&&(this.computedResult=e,this.lastComputed=n),t},V.min=function(t){return t=V.iteratee(t),V.resolveSingleValue(this),function(e){return new f(t,e)}},f.prototype.init=t,f.prototype.result=function(t){return t=this.xf.step(t,this.computedResult),this.xf.result(t)},f.prototype.step=function(t,e){var n=this.f(e);return(n<this.lastComputed||1/0===n&&1/0===this.computedResult)&&(this.computedResult=e,this.lastComputed=n),t},V.push=function(){var t=R.toArray(arguments);return function(e){return new c(t,e)}},c.prototype.init=t,c.prototype.result=function(t){var e,n=this.toPush,r=n.length;for(e=0;r>e;e++)t=this.xf.step(t,n[e]);return this.xf.result(t)},c.prototype.step=e,V.unshift=function(){var t=R.toArray(arguments);return function(e){return new a(t,e)}},a.prototype.init=t,a.prototype.result=n,a.prototype.step=function(t,e){var n=this.toUnshift;if(n){var r,i=n.length;for(r=0;i>r;r++)t=this.xf.step(t,n[r])}return this.toUnshift=null,this.xf.step(t,e)},V.first=V.head=V.take=function(t){return t===g?(V.resolveSingleValue(this),t=1):t=t>0?t:0,C.take(t)},V.initial=function(t){return t=t===g?1:t>0?t:0,function(e){return new h(t,e)}},h.prototype.init=t,h.prototype.result=function(t){var e=0,n=this.idx-this.n,r=this.buffer;for(e=0;n>e;e++)t=this.xf.step(t,r[e]);return t},h.prototype.step=function(t,e){return this.buffer[this.idx++]=e,t},V.last=function(t){return t===g?(V.resolveSingleValue(this),t=1):t=t>0?t:0,function(e){return new l(t,e)}},l.prototype.init=t,l.prototype.result=function(t){var e=this.n,n=e,r=this.buffer,i=this.idx;for(n>i&&(n=i,i=0);n--;)t=this.xf.step(t,r[i++%e]);return this.xf.result(t)},l.prototype.step=function(t,e){return this.buffer[this.idx++%this.n]=e,t},V.rest=V.tail=V.drop=function(t){return t=t===g?1:t>0?t:0,C.drop(t)},V.compact=function(){return V.filter(R.identity)},V.uniq=V.unique=function(t,e){return R.isBoolean(t)||(e=t,t=!1),null!=e&&(e=V.iteratee(e)),function(n){return new d(e,t,n)}},d.prototype.init=t,d.prototype.result=n,d.prototype.step=function(t,e){var n=this.seen;if(this.isSorted)this.i&&n===e||(t=this.xf.step(t,e)),this.seen=e,this.i++;else if(this.f){var r=this.f(e);R.indexOf(n,r)<0&&(n.push(r),t=this.xf.step(t,e))}else R.indexOf(n,e)<0&&(n.push(e),t=this.xf.step(t,e));return t},V.tap=function(t){return function(e){return new y(t,e)}},y.prototype.init=t,y.prototype.result=n,y.prototype.step=function(t,e){return this.f(t,e,this.i++),this.xf.step(t,e)},V.mixin=function(t){R.each(R.functions(t),function(e){var n=V[e]=t[e];V.prototype[e]=function(){var t=n.apply(this,arguments);return V(this,t)}})},V.mixin(V),V.as=function(t){return t instanceof V?t:null},V.noConflict=function(){return S._r=_,this},V.prototype.withSource=function(t){return V(t,this)},V.prototype.transducer=V.prototype.compose=function(){var t=this._wrappedFns;return t.length?R.compose.apply(null,t):g},V.resolveSingleValue=function(t){m(t,!0)},V.resolveMultipleValues=function(t){m(t,!1)};var k={};V.prototype.value=function(){if(!this._resolveSingleValue)return this.into();var t=this.into(k);return t===k?g:t};var j=R.reduce(["iterator","iteratee","empty","append","wrap","unwrap"],function(t,e){var n=function(){for(var t,r=arguments,i=n._fns,u=i.length,o=V.as(this);u--;)if(t=i[u].apply(o,r),t!==g)return t;throw new TypeError("cannot find match for "+e+" "+R.toArray(r))};return n._fns=[],n.register=function(t){n._fns.push(t)},t[e]=n,t},{});V.wrap=function(t){return j.wrap.call(this,t)},V.wrap.register=function(t){return j.wrap.register(t)},V.wrap.register(function(t){return null==t&&(t=V.empty()),t}),V.unwrap=V.deref=function(t){return j.unwrap(t)},V.unwrap.register=function(t){return j.unwrap.register(t)},V.unwrap.register(function(t){return V.isReduced(t)?t.value:V.as(t)?r.value():t}),V.iterator=function(t){return j.iterator(t)},V.iterator.register=function(t){return j.iterator.register(t)};var F="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator";V.iterator.Symbol=F,V.iterator.register(function(t){if(R.isObject(t)){var e=t[F]&&t[F]()||t;if(R.isFunction(e.next))return e}return null}),V.iteratee=function(t){return j.iteratee(t)},V.iteratee.register=function(t){return j.iteratee.register(t)},V.iteratee.register(function(t){return V.as(t)?v(t):R.iteratee(t)}),V.empty=function(t){return t===k?k:j.empty(t)},V.empty.register=function(t){return j.empty.register(t)},V.empty.register(function(t){return t===g||R.isArray(t)||V.iterator(t)?[]:R.isObject(t)?{}:k}),V.append=V.conj=V.conjoin=function(t,e,n){return t===g?[]:e===g?V.unwrap(t):e===k?t:t===k?e:j.append(t,e,n)},V.append.register=function(t){return j.append.register(t)},V.append.register(function(t,e,n){return R.isArray(t)?(t.push(e),t):n!==g&&R.isObject(t)?(t[n]=e,t):e}),x.prototype.init=V.empty,x.prototype.result=V.unwrap,x.prototype.step=V.append,w.prototype.init=R.identity,w.prototype.result=R.identity,w.prototype.step=function(t,e){return e},V.reduced=function(t){return C.ensureReduced(t)},V.isReduced=function(t){return C.isReduced(t)},V.reduce=V.foldl=V.inject=function(t,e,n){return null==n&&(n=V.empty(n)),C.reduce(t,e,n)},V.transduce=function(t,e,n,r){return V.as(t)&&(t=t.compose()),V.unwrap(C.transduce(t,e,n,r))},V.prototype.transduce=function(t,e,n){return n===g&&(n=this._wrapped),V.transduce(this,t,e,n)},V.asCallback=function(t,e){var n,r,i=!1;return V.as(t)&&(t=t.compose()),n=e===g?t(new w):t(new x),r=n.init(),function(t){return i?r:(t===g?(r=n.result(r),i=!0):(r=n.step(r,t),V.isReduced(r)&&(r=n.result(V.unwrap(r)),i=!0)),i?r:void 0)}},V.prototype.asCallback=function(t){return V.asCallback(this,t)},V.asyncCallback=function(t,e,n){function r(t,n){if(o)return!0;if(t=t||null,V.isReduced(u)&&(u=V.unwrap(u),o=!0),(t||o||n===g)&&(u=i.result(u),o=!0),o){if(e)e(t,u),e=null;else if(t)throw t;u=null}return o}var i,u,o=!1;return V.as(t)&&(t=t.compose()),i=n===g?t(new w):t(new x),u=i.init(),function(t,e){if(!r(t,e))try{u=i.step(u,e),r(t,e)}catch(n){r(n,e)}}},V.prototype.asyncCallback=function(t,e){return V.asyncCallback(this,t,e)},V.into=function(t,e,n){var r=V.append;return n===g&&(n=e,e=g),n===g&&(n=V.empty()),V.as(e)&&(e=e.compose()),e===g?V.reduce(r,t,n):V.transduce(e,r,t,n)},V.prototype.into=function(t,e){return e===g&&(e=this._wrapped),e===g&&(e=V.empty()),t===g&&(t=V.empty(e)),V.into(t,this,e)},V.sequence=function(t,e){return V.into(V.empty(e),t,e)},V.prototype.sequence=function(t){return this.into(V.empty(t),t)},V.generate=function(t,e){var n={};return n[F]=function(){var n=e?t():t;return{next:function(){var t=n();return t===g?{done:!0}:{done:!1,value:t}}}},n},V.prototype.generate=function(t,e){return this.withSource(V.generate(t,e))},"function"==typeof define&&define.amd&&define("underscore.transducer",[],function(){return V})}.call(this);