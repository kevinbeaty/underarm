!function(){function n(n,r){n instanceof a&&(n._resolveSingleValue=r)}function e(n){this.value=n}var t,u=this,i=u._r,o=Array.prototype.slice,a=function(n,r){if(n instanceof a){if(r===t)return n;var e=c.clone(n._wrappedFns);e.push(r);var u=new a(n._wrapped,e);return u._resolveSingleValue=n._resolveSingleValue,u}return this instanceof a?(r instanceof a&&(r=r._wrappedFns,this._resolveSingleValue=r._resolveSingleValue),this._wrappedFns=c.isFunction(r)?[r]:c.isArray(r)?c.filter(r,c.isFunction):[],this._wrapped=a.wrap.call(this,n),void 0):new a(n,r)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports._r=a):u._r=a,a.VERSION="0.0.8";var c=u._;"undefined"==typeof c&&"undefined"!=typeof require&&(c=require("underscore")._),a.each=a.forEach=function(n){return function(r){return function(e,u,i){return e===t?r():u===t?r(e):(n(u,i),r(e,u,i))}}},a.map=a.collect=function(n){return n=c.iteratee(n),function(r){return function(e,u,i){return e===t?r():u===t?r(e):r(e,n(u,i),i)}}},a.find=a.detect=function(n){return n=c.iteratee(n),a.resolveSingleValue(this),function(r){return function(e,u,i){return e===t?r():u===t?r(e):n(u,i)?a.reduced(r(e,u,i)):e}}},a.filter=a.select=function(n){return n=c.iteratee(n),function(r){return function(e,u,i){return e===t?r():u===t?r(e):n(u,i)?r(e,u,i):e}}},a.reject=function(n){return a.filter(c.negate(c.iteratee(n)))},a.every=a.all=function(n){return n=c.iteratee(n),a.resolveSingleValue(this),function(r){var e=!1;return function(u,i,o){return u===t?r():i===t?(e||(u=r(u,!0)),r(u)):n(i,o)?u:(e=!0,a.reduced(r(u,!1)))}}},a.some=a.any=function(n){return n=c.iteratee(n),a.resolveSingleValue(this),function(r){var e=!1;return function(u,i,o){return u===t?r():i===t?(e||(u=r(u,e)),r(u)):n(i,o)?(e=!0,a.reduced(r(u,e,o))):u}}},a.contains=a.include=function(n){return a.some.call(this,function(r){return r===n})},a.invoke=function(n){var r=o.call(arguments,2),e=c.isFunction(n);return a.map(function(t){return(e?n:t[n]).apply(t,r)})},a.pluck=function(n){return a.map(c.property(n))},a.where=function(n){return a.filter(c.matches(n))},a.findWhere=function(n){return a.find.call(this,c.matches(n))},a.max=function(n){return n=c.iteratee(n),a.resolveSingleValue(this),function(r){var e,u=-1/0,i=-1/0;return function(o,a,c){return o===t?r():a===t?(o=r(o,u),r(o)):(e=n(a,c),(e>i||e===-1/0&&u===-1/0)&&(u=a,i=e),o)}}},a.min=function(n){return n=c.iteratee(n),a.resolveSingleValue(this),function(r){var e,u=1/0,i=1/0;return function(o,a,c){return o===t?r():a===t?(o=r(o,u),r(o)):(e=n(a,c),(i>e||1/0===e&&1/0===u)&&(u=a,i=e),o)}}},a.push=function(){var n=c.toArray(arguments);return function(r){return function(e,u,i){if(e===t)return r();if(u===t){var o,a=n.length;for(o=0;a>o;o++)e=r(e,n[o]);return r(e)}return r(e,u,i)}}},a.unshift=function(){var n=c.toArray(arguments);return function(r){return function(e,u,i){if(e===t)return r();if(u===t)return r(e);if(n){var o,a=n.length;for(o=0;a>o;o++)e=r(e,n[o]);n=null}return r(e,u,i)}}},a.first=a.head=a.take=function(n){return n===t?(a.resolveSingleValue(this),n=1):n=n>0?n:0,function(r){var e=n;return function(n,u,i){return n===t?r():u===t?r(n):(e>0&&(n=r(n,u,i)),--e?n:a.reduced(n))}}},a.initial=function(n){return n=n===t?1:n>0?n:0,function(r){var e=0,u=[],i=0;return function(o,a){if(o===t)return r();if(a===t){for(e=i-n,i=0;e>i;i++)o=r(o,u[i]);return r(o)}return u[i++]=a,o}}},a.last=function(n){return n===t?(a.resolveSingleValue(this),n=1):n=n>0?n:0,function(r){var e=n,u=[],i=0;return function(o,a){if(o===t)return r();if(a===t){for(;e--;)o=r(o,u[i++%n]);return r(o)}return u[i++%n]=a,o}}},a.rest=a.tail=a.drop=function(n){return n=n===t?1:n>0?n:0,function(r){var e=n;return function(n,u,i){return n===t?r():u===t?r(n):e>0?(e--,n):r(n,u,i)}}},a.compact=function(){return a.filter(c.identity)},a.uniq=a.unique=function(n,r){return c.isBoolean(n)||(r=n,n=!1),null!=r&&(r=c.iteratee(r)),function(e){var u=[],i=0;return function(o,a,f){if(o===t)return e();if(a===t)return e(o);if(n)i&&u===a||(o=e(o,a,f)),u=a;else if(r){var s=r(a,i,o);c.indexOf(u,s)<0&&(u.push(s),o=e(o,a,f))}else c.indexOf(u,a)<0&&(u.push(a),o=e(o,a,f));return++i,o}}},a.tap=function(n){return function(r){return function(e,u,i){return e===t?r():u===t?r(e):(n(e,u,i),r(e,u,i))}}},a.mixin=function(n){c.each(c.functions(n),function(r){var e=a[r]=n[r];a.prototype[r]=function(){var n=e.apply(this,arguments);return a(this,n)}})},a.mixin(a),a.noConflict=function(){return u._r=i,this},a.prototype.withSource=function(n){return a(n,this)},a.prototype.transducer=a.prototype.compose=function(){var n=this._wrappedFns;return n.length?c.compose.apply(null,n):t},a.resolveSingleValue=function(r){n(r,!0)},a.resolveMultipleValues=function(r){n(r,!1)};var f={};a.prototype.value=function(){if(!this._resolveSingleValue)return this.into();var n=this.into(f);return n===f?t:n};var s=c.reduce(["iterator","empty","append","wrap","unwrap"],function(n,r){var e=function(){for(var n,u=arguments,i=e._fns,o=i.length,f=this instanceof a?this:null;o--;)if(n=i[o].apply(f,u),n!==t)return n;throw new TypeError("cannot find match for "+r+" "+c.toArray(u))};return e._fns=[],e.register=function(n){e._fns.push(n)},n[r]=e,n},{});a.wrap=function(n){return s.wrap.call(this,n)},a.wrap.register=function(n){return s.wrap.register(n)},a.wrap.register(function(n){return n===t&&(n=a.empty()),n}),a.unwrap=a.deref=function(n){return s.unwrap(n)},a.unwrap.register=function(n){return s.unwrap.register(n)},a.unwrap.register(function(n){return a.isReduced(n)?n.value:n instanceof a?r.value():n}),a.iterator=function(n){return s.iterator(n)},a.iterator.register=function(n){return s.iterator.register(n)};var l="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator";a.iterator.Symbol=l,a.iterator.register(function(n){if(c.isObject(n)){var r=n[l]&&n[l]()||n;if(c.isFunction(r.next))return r}return null}),a.empty=function(n){return n===f?f:s.empty(n)},a.empty.register=function(n){return s.empty.register(n)},a.empty.register(function(n){return n===t||c.isArray(n)?[]:c.isObject(n)?{}:f}),a.append=a.conj=a.conjoin=function(n,r,e){return n===t?[]:r===t?a.unwrap(n):r===f?n:n===f?r:s.append(n,r,e)},a.append.register=function(n){return s.append.register(n)},a.append.register(function(n,r,e){return c.isArray(n)?(n.push(r),n):e!==t&&c.isObject(n)?(n[e]=r,n):r}),a.reduced=function(n){return new e(n)},a.isReduced=function(n){return n instanceof e};var p="Reduce of empty array with no initial value";a.reduce=a.foldl=a.inject=function(n,r,e){null==n&&(n=a.empty());var t,u=n.length!==+n.length&&c.keys(n),i=(u||n).length,o=0,f=a.iterator(n);if(f&&c.isFunction(f.next))for(;;){if(t=f.next(),t.done)return e;if(e=r(e,t.value,o++,n),a.isReduced(e))return a.unwrap(e)}else{if(arguments.length<3){if(!i)throw new TypeError(p);e=n[u?u[o++]:o++]}for(;i>o;o++)if(t=u?u[o]:o,e=r(e,n[t],t,n),a.isReduced(e))return a.unwrap(e)}return e},a.transduce=function(n,r,e,u){return r===t&&(r=a.empty()),e===t&&(e=a.append),u===t&&(u=e()),n instanceof a&&(n=n.transducer()),n!==t&&(e=n(e)),e(a.reduce(r,e,u))},a.prototype.transduce=function(n,r,e){return n===t?a.transduce(this.transducer(),this._wrapped,n,r):a.transduce(this.transducer(),n,r,e)},a.asCallback=function(n,r){var e=!1,u=a.append;return r===t&&(r=null),u=n(u),function(n){e||(n===t?(r=u(r),e=!0):(r=u(r,n),a.isReduced(r)&&(r=u(a.unwrap(r)),e=!0)))}},a.prototype.asCallback=function(n){return a.asCallback(this.transducer(),n)},a.asyncCallback=function(n,r,e){function u(n,u){if(i)return!0;if(n=n||null,a.isReduced(e)&&(e=a.unwrap(e),i=!0),(n||i||u===t)&&(e=o(e),i=!0),i){if(r)r(n,e),r=null;else if(n)throw n;e=null}return i}var i=!1,o=a.append;return e===t&&(e=null),o=n(o),function(n,r){if(!u(n,r))try{e=o(e,r),u(n,r)}catch(t){u(t,r)}}},a.prototype.asyncCallback=function(n,r){return a.asyncCallback(this.transducer(),n,r)},a.into=function(n,r,e){var u=a.append;return e===t&&(e=r,r=t),e===t&&(e=a.empty()),r===t?a.reduce(e,u,n):a.transduce(r,e,u,n)},a.prototype.into=function(n,r){return r===t&&(r=this._wrapped),r===t&&(r=a.empty()),n===t&&(n=a.empty(r)),a.into(n,this.transducer(),r)},a.sequence=function(n,r){return r==t?(r=n,a.into(a.empty(r),r)):a.into(a.empty(r),n,r)},a.prototype.sequence=function(n){return n==t&&(n=this._wrapped),this.into(a.empty(n),n)},a.generate=function(n,r){var e={};return e[l]=function(){var e=r?n():n;return{next:function(){var n=e();return n===t?{done:!0}:{done:!1,value:n}}}},e},a.prototype.generate=function(n,r){return this.withSource(a.generate(n,r))},"function"==typeof define&&define.amd&&define("underscore.transducer",[],function(){return a})}.call(this);